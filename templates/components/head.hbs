<!DOCTYPE html>
<html lang="{{language}}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{pageTitle}}</title>
    {{> meta 
        ogType="article"
        ogUrl=postUrl
        ogTitle=post.title
        ogDescription=post.excerpt
        ogImage=postImage
        ogSiteName=title
        twitterUrl=postUrl
        twitterTitle=post.title
        twitterDescription=post.excerpt
        twitterImage=postImage
        isArticle=true
        articlePublishedTime=post.date
        articleModifiedTime=post.date
        articleAuthor=author
        articleSection=articleSection
        articleTags=post.tags
    }}

    <meta name="description" content="{{description}}">
    <meta name="author" content="{{author}}">
    <meta name="language" content="{{language}}">
    
    <!-- Enhanced SEO Meta Tags -->
    <meta name="keywords" content="{{#if keywords}}{{keywords}}{{else}}blog, technology, programming, software development, reverse engineering, assembly language{{/if}}">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">
    <link rel="canonical" href="{{canonicalUrl}}">
    <meta name="theme-color" content="#1e293b">
    <meta name="msapplication-TileColor" content="#1e293b">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="{{title}}">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Resource Hints for Performance -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="/styles.css" as="style">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;600;700&display=swap" as="style" crossorigin>
    
    <!-- Sitemap and RSS Links -->
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">
    <link rel="alternate" type="application/rss+xml" title="{{title}} RSS Feed" href="/rss.xml">
    <link rel="alternate" type="application/atom+xml" title="{{title}} Atom Feed" href="/atom.xml">

    <!-- Preload fonts for better performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;600;700&display=swap"></noscript>
    
    <!-- Common CSS and Fonts -->
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Common Styles -->
    <style>
    /* small helpers outside of Tailwind for accessibility and responsive type */
    :root{--max-content-width:65ch}

    /* Responsive fluid type for body */
    html {font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;}
    body {font-size: clamp(15px, 1.6vw, 17px);}

    /* Focus visible custom (prefers reduced motion respected) */
    :focus {outline: none}
    :focus-visible{outline: 3px solid rgba(6,182,212,0.9); outline-offset: 3px}

    @media (prefers-reduced-motion: reduce){
      * {transition: none !important; animation: none !important}
    }

    /* Code block better defaults */
    pre {font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular; font-size: 0.92rem}

    /* small utility for visually-hidden but available to screen readers */
    .sr-only {position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
    
    /* Enhanced smooth transitions for theme switching */
    html {
      transition: background-color 0.4s ease, color 0.4s ease;
    }
    
    body {
      transition: background-color 0.4s ease, color 0.4s ease;
    }
    
    /* Smooth transitions for specific elements */
    header, main, footer, article, section, aside {
      transition: background-color 0.4s ease, border-color 0.4s ease, color 0.4s ease;
    }
    
    /* Smooth transitions for form elements */
    input, button, textarea, select {
      transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
    }

    /* Custom scrollbar for webkit browsers */
    .scrollbar-none::-webkit-scrollbar {
        display: none;
    }

    .scrollbar-none {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }

    /* Smooth scrolling for touch devices */
    .scrollbar-none {
        -webkit-overflow-scrolling: touch;
    }

    /* Simple scroll indicators */
    .tags-scroll-left,
    .tags-scroll-right {
        z-index: 2;
        pointer-events: auto;
        transition: all 0.2s ease;
    }

    .tags-scroll-left:hover,
    .tags-scroll-right:hover {
        transform: translateY(-50%) scale(1.1);
    }

    /* Ensure indicators are positioned correctly */
    .tags-scroll-left {
        left: 0.5rem; /* 8px from left edge */
        width: 2rem; /* 32px - same as indicator width */
    }

    .tags-scroll-right {
        right: 0.5rem; /* 8px from right edge */
        width: 2rem; /* 32px - same as indicator width */
    }

    /* GitHub-style markdown alerts */
    .markdown-alert {
        @apply border-l-4 p-3 my-3 rounded-r-md;
    }

    .markdown-alert-note {
        @apply border-blue-500 bg-blue-50 dark:bg-blue-900/20;
    }

    .markdown-alert-tip {
        @apply border-green-500 bg-green-50 dark:bg-green-900/20;
    }

    .markdown-alert-important {
        @apply border-purple-500 bg-purple-50 dark:bg-purple-900/20;
    }

    .markdown-alert-warning {
        @apply border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20;
    }

    .markdown-alert-caution {
        @apply border-red-500 bg-red-50 dark:bg-red-900/20;
    }

    .markdown-alert-title {
        @apply font-semibold mb-2;
    }

    .markdown-alert-note .markdown-alert-title {
        @apply text-blue-500;
    }

    .markdown-alert-tip .markdown-alert-title {
        @apply text-green-500;
    }

    .markdown-alert-important .markdown-alert-title {
        @apply text-purple-500;
    }

    .markdown-alert-warning .markdown-alert-title {
        @apply text-yellow-500;
    }

    .markdown-alert-caution .markdown-alert-title {
        @apply text-red-500;
    }

    /* Override highlight.js styles to remove backgrounds */
    .hljs-line {
        background: none !important;
    }

    .hljs-keyword,
    .hljs-selector-tag,
    .hljs-literal,
    .hljs-section,
    .hljs-link,
    .hljs-function .hljs-keyword,
    .hljs-subst {
        background: none !important;
    }

    /* Override Tailwind's prose styles for code */
    .prose-custom code {
        background: none !important;
        padding: 0 !important;
        margin: 0 !important;
        border-radius: 0 !important;
        font-size: inherit !important;
    }

    .prose-custom pre code {
        background: none !important;
        padding: 0 !important;
        margin: 0 !important;
    }

    /* Dark mode overrides for prose code */
    .dark .prose-custom code:is(.dark *) {
        background: none !important;
        color: inherit !important;
    }

    .dark .prose-custom pre code:is(.dark *) {
        background: none !important;
        color: inherit !important;
    }
    </style>
    
    <!-- Theme initialization script - runs before body renders -->
    <script>
        (function() {
            const stored = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            if (stored === 'dark' || (!stored && prefersDark)) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>
</head>
